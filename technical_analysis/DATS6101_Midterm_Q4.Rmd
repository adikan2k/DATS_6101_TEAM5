---
title: "Analysis of Trends in Fatal Accidents"
Team: "5"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)  
library(lubridate) 
library(ggplot2)  
```

## 1. Introduction (SMART Question 4)
This analysis addresses one critical SMART question:
4. Are there noticeable trends in fatal accidents throughout the year 2022, and has the number of fatalities been increasing or decreasing in certain regions?

We will be using the 2022 Fatality Analysis Reporting System (FARS) dataset to explore this question, focusing on trends.

## 2. Data Loading and Preparation

```{r data-loading}
# Load the dataset
fars_data <- read.csv("NTAD_Fatality_Analysis_Reporting_System_2022_Accidents_3270373163975898856.csv")

glimpse(fars_data)
summary(fars_data)
```

### Data Preparation
- **Year Extraction**: If the dataset contains a 'Date' or 'Year' column, ensure proper formatting.
- **Filtering Relevant Columns**: Focus on columns relevant to year, region, and fatality status.

```{r data-preparation}
if ("DATE" %in% names(fars_data)) {
  fars_data$DATE <- as.Date(fars_data$DATE, format="%Y-%m-%d")
  fars_data$MONTH <- month(fars_data$DATE, label = TRUE)
}

glimpse(fars_data)
summary(fars_data)
```

## 3. Monthly trends for 2022


# Analyzing fatalities by month to identify seasonal patterns
```{r}
monthly_summary <- fars_data %>% 
  group_by(MONTH) %>% 
  summarize(total_fatalities = n(), .groups = 'drop')

ggplot(monthly_summary, aes(x=MONTH, y=total_fatalities)) +
  geom_line(group=1, color="blue", size=1.2) +
  geom_point(color="red", size=3) +
  scale_x_continuous(breaks=1:12) +  
  labs(title="Trends in Fatal Accidents by Month (2022)",
       x="Month",
       y="Total Fatalities") +
  theme_minimal()
```

### Regional Analysis for the year 2022

```{r, fig.width=14, fig.height=10}
state_monthly_summary <- fars_data %>% 
  group_by(STATENAME, MONTH) %>% 
  summarize(total_fatalities = n(), .groups = 'drop')

print(head(state_monthly_summary))

ggplot(state_monthly_summary, aes(x=MONTH, y=total_fatalities, color=STATENAME, group=STATENAME)) +
  geom_line(size=1, alpha=0.7) +  
  geom_point(size=2, alpha=0.8) +  
  scale_x_continuous(breaks=1:12) + 
  scale_y_continuous(breaks = seq(0, max(state_monthly_summary$total_fatalities, na.rm = TRUE), by = 10)) + 
  labs(title="State-wise Trends in Fatal Accidents by Month",
       x="Month",
       y="Total Fatalities",
       color="State") +
  theme_minimal() +
  theme(legend.position = "bottom", 
        axis.text.x = element_text(angle = 45, hjust = 1), 
        panel.grid.minor = element_blank()) 


ggsave("enlarged_state_trends.png", width = 18, height = 12, dpi = 300)
```
## 4. Insights and Recommendation


# Summarize the monthly and regional trends
```{r}
peak_month <- monthly_summary$MONTH[which.max(monthly_summary$total_fatalities)]

cat("Summary of Findings:\n")
cat("- The month with the highest number of fatal accidents in 2022 was", peak_month, ".\n")

```

# Identify the region with the highest fatalities in each month

```{r}
regional_monthly_summary <- fars_data %>% 
  group_by(STATENAME, MONTH) %>% 
  summarize(total_fatalities = n(), .groups = 'drop')

high_risk_states <- regional_monthly_summary %>% 
  group_by(MONTH) %>% 
  slice(which.max(total_fatalities)) %>% 
  select(MONTH, STATENAME, total_fatalities)

cat("States with the highest number of fatalities for each month:\n")
print(high_risk_states)
```


#Conclusion for the following question

#Checking if the no.of fatalities have been decreasing or increasing over the months in different regions

```{r}
regional_trends <- fars_data %>% 
  group_by(STATENAME, MONTH) %>% 
  summarize(total_fatalities = n(), .groups = 'drop')

trend_direction <- regional_trends %>%
  group_by(STATENAME) %>%
  summarize(trend = cor(MONTH, total_fatalities, use="complete.obs")) %>%
  mutate(direction = ifelse(trend > 0, "Increasing", "Decreasing"))

cat("Trend Analysis Summary for Fatalities in 2022:\n")
print(trend_direction)
```
